<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How Does run_as work? &mdash; PluginPlay 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8d563738"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PluginPlay Frequently Asked Questions" href="../faqs.html" />
    <link rel="prev" title="Checkpoint/Restart" href="design/checkpoint_restart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">PluginPlay Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">List of PluginPlay Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing PluginPlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">PluginPlay Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="design/index.html">Design Topics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">How Does run_as work?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">PluginPlay Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography/bibliography.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">APIs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex.github.io/PluginPlay/pluginplay_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PluginPlay</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Developer Documentation</a></li>
      <li class="breadcrumb-item active">How Does run_as work?</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/developer/how_does_run_as_work.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-does-run-as-work">
<h1>How Does run_as work?<a class="headerlink" href="#how-does-run-as-work" title="Link to this heading"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">ModuleManager::run_as</span></code> is the workhorse of running a call graph. The point
of this page is to succinctly summarize the behind-the-scenes actions of this
function.</p>
<figure class="align-center" id="id1">
<span id="fig-run-as-call-graph"></span><img alt="../_images/run_as_call_graph.png" src="../_images/run_as_call_graph.png" />
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Overview of the control flow of <code class="docutils literal notranslate"><span class="pre">ModuleManager::run_as</span></code>. Boxes denote
methods, ovals data. Arrows between methods point from caller to the callee.
Arrows stemming from data indicate data is input. Arrows ending in data
indicate that data results. When a method calls multiple sub-methods the
call order is depicted left-to-right. Note <code class="docutils literal notranslate"><span class="pre">pre_run</span></code> and <code class="docutils literal notranslate"><span class="pre">post_run</span></code> are
conceptual</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The call graph of <code class="docutils literal notranslate"><span class="pre">ModuleManager::run_as</span></code> (as seen from C++)  is summarized in
<a class="reference internal" href="#fig-run-as-call-graph"><span class="std std-numref">Fig. 15</span></a>. Briefly:</p>
<ol class="arabic simple">
<li><p>Many users enter the call graph via <code class="docutils literal notranslate"><span class="pre">ModuleManager::run_as</span></code>; however, this
method simply wraps retrieving the specified module and forwarding the
results to that module’s  <code class="docutils literal notranslate"><span class="pre">Module::run_as</span></code> method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Module::run_as</span></code> is the typed user interface. It works with the objects’
native C++ types, i.e., inputs and results are actual C++ objects. Under the
hood <code class="docutils literal notranslate"><span class="pre">Module::run_as</span></code> is responsible for type-erasing inputs and restoring
types to results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PropertyType::wrap_inputs</span></code> this is the method that <code class="docutils literal notranslate"><span class="pre">Module::run_as</span></code>
calls to type-erase the inputs. The property type class is essentially a
schema written in terms of domain-specific types.</p></li>
<li><p>With type-erased inputs the next call is to the type-erased user-interface,
<code class="docutils literal notranslate"><span class="pre">Module::run</span></code>.</p></li>
<li><p>The first thing <code class="docutils literal notranslate"><span class="pre">Module::run</span></code> does is to merge the user-provided inputs
with the bound inputs. The result is the full set of inputs for the module.</p></li>
<li><p>Next, <code class="docutils literal notranslate"><span class="pre">Module::run</span></code> determines if the module is ready to run, e.g., does
it have all the inputs needed to run? Has a submodule been assigned to each
callback point? Is each submodule ready to run?</p></li>
<li><p>Assuming the module is ready to run, <code class="docutils literal notranslate"><span class="pre">Module::run</span></code> then locks the module
(and all submodules). A locked module can no longer have its options or
submodules changed.</p></li>
<li><p>After locking the module, the actual module contents are run via
<code class="docutils literal notranslate"><span class="pre">ModuleBase::run</span></code> (which calls the derived class’s <code class="docutils literal notranslate"><span class="pre">run_</span></code> method).</p></li>
<li><p>The results of <code class="docutils literal notranslate"><span class="pre">Module::run</span></code> are type-erased, so the final step is for
<code class="docutils literal notranslate"><span class="pre">Module::run_as</span></code> to restore their types before returning them to the user.</p></li>
</ol>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="design/checkpoint_restart.html" class="btn btn-neutral float-left" title="Checkpoint/Restart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../faqs.html" class="btn btn-neutral float-right" title="PluginPlay Frequently Asked Questions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>