<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Checkpoint/Restart &mdash; PluginPlay 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=8d563738"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How Does run_as work?" href="../how_does_run_as_work.html" />
    <link rel="prev" title="Memoization Design" href="memoization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/full_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../background/index.html">PluginPlay Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">List of PluginPlay Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing PluginPlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">PluginPlay Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Design Topics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="module_manager.html">Designing the Module Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="module.html">Designing the Module Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="property_type.html">Designing the Property Type Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="field.html">Designing the Field Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html">Cache Design</a></li>
<li class="toctree-l3"><a class="reference internal" href="database.html">Database Design</a></li>
<li class="toctree-l3"><a class="reference internal" href="call_graph.html">Designing the Call Graph Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="memoization.html">Memoization Design</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Checkpoint/Restart</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-is-c-r">What is C/R?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#why-do-we-need-c-r">Why Do We Need C/R?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-r-considerations">C/R Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-r-implementations">C/R Implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-r-strategy">C/R Strategy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../how_does_run_as_work.html">How Does run_as work?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html">PluginPlay Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography/bibliography.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">APIs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex.github.io/PluginPlay/pluginplay_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PluginPlay</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Developer Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Design Topics</a></li>
      <li class="breadcrumb-item active">Checkpoint/Restart</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developer/design/checkpoint_restart.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="checkpoint-restart">
<span id="design-checkpoint-restart"></span><h1>Checkpoint/Restart<a class="headerlink" href="#checkpoint-restart" title="Link to this heading"></a></h1>
<p>The need for checkpoint/restart (C/R) was briefly touched upon in
<a class="reference internal" href="memoization.html#memoization-design"><span class="std std-ref">Memoization Design</span></a> with a full discussion deferred to this section. From
the PluginPlay perspective C/R is a subset of the memoization needs, more
specifically C/R amounts to avoiding recomputation by using a previously created
checkpoint. In PluginPlay C/R is unified with memoization by using the
checkpoint to create a Cache instance.</p>
<section id="what-is-c-r">
<h2>What is C/R?<a class="headerlink" href="#what-is-c-r" title="Link to this heading"></a></h2>
<p>C/R is the high-performance computing equivalent of saving/loading. In
conventional usage C/R primarily targets fault resilience (being able to resume
a program when something goes wrong) and is typically done in the background of
the program’s execution. Typical C/R usage usually has a short turn around time
from the checkpoint action to restarting. On the contrary, saving/loading is
typically a manual process (the chooses to save; although the program may also
maintain an autosave back-up as a convenience) and usually strives to store the
data in a manner ammenable to resuming work after a prolonged period of time. In
modern practice the exact distinction between save/load and C/R is fuzzy at
best and for our purposes we consider them together under the unified concept of
C/R.</p>
<p>C/R is typically handled in one of two ways: by the operating system (OS) or by
the application. While OS-based C/R is automatic (from the application
developer’s perspective) it’s of limited utility in that it’s extremely
expensive (the OS more or less snapshots the state of all running programs and
all memory). The main application of OS-based C/R is suspending/hibernating the
current user’s session. OS-based C/R is typically not designed for transferring
the checkpoint state to other devices and the next user action after a
checkpoint is expected to be resuming the session (albeit with possibly a
significant amount of time between the actions). On the contrary,
application-based C/R is not automatic (although tools help to facilitate it),
can be expensive or cheap (depends on what is being checkpointed and how the
developer does the checkpointing), and allows other actions to occur between the
checkpoint and the restart.</p>
</section>
<section id="why-do-we-need-c-r">
<h2>Why Do We Need C/R?<a class="headerlink" href="#why-do-we-need-c-r" title="Link to this heading"></a></h2>
<p>Historically many electronic structure packages have had limited or no C/R
capabilities. However, fault rates are expected to increase substantially with
exascale computing making it prudent for us to consider C/R if for no other
reason than resliancy. Arguably the more important reason to have C/R is for
scientific integrity. It should be possible to reload previous results and
verify/build upon them in some manner. Another reason is user friendliness.
Users have come to expect their state to be saved in most serious programs.
Having C/R means a user doesn’t need to rerun the entire program just because
an error occurred.</p>
</section>
<section id="c-r-considerations">
<h2>C/R Considerations<a class="headerlink" href="#c-r-considerations" title="Link to this heading"></a></h2>
<p>There are a number of C/R considerations which we have grouped based on whether
they pertain to the objects being C/R, the hardware being used to C/R, or the
design of PluginPlay.</p>
<section id="object-considerations">
<h3>Object Considerations<a class="headerlink" href="#object-considerations" title="Link to this heading"></a></h3>
<ul>
<li><p>The amount of data to checkpoint can be formidable</p>
<blockquote>
<div><ul class="simple">
<li><p>Need ways to control what is checkpointed</p></li>
<li><p>Does the ability to turn on/off memoization suffice?</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Will need to checkpoint distributed objects</p>
<blockquote>
<div><ul class="simple">
<li><p>For traditional memoization want to keep the object distributed.</p></li>
<li><p>For C/R likely will want to pull the objects back to a single (or small
number of files)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>May need to checkpoint different objects at different frequencies</p>
<blockquote>
<div><ul class="simple">
<li><p>To minimize checkpointing overhead larger objects may be checkpointed less
frequently than smaller objects.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Serialization is the primary means of disassembling/assembling objects and
thus intimately related to C/R</p></li>
</ul>
</section>
<section id="hardware-considerations">
<h3>Hardware Considerations<a class="headerlink" href="#hardware-considerations" title="Link to this heading"></a></h3>
<ul>
<li><p>Exascale machines include memory hierarchies that need checkpointed (e.g.
burst buffers, nonvolatile memory)</p></li>
<li><p>Should checkpoints be hardware-specific (e.g. checkpoint may assume access to
a certain number of processes)</p>
<blockquote>
<div><ul class="simple">
<li><p>For immediate restart, hardware-specific checkpoints make sense, but for
long-term archival the storage format needs to be platform agnostic</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="pluginplay-specific-considerations">
<h3>PluginPlay Specific Considerations<a class="headerlink" href="#pluginplay-specific-considerations" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Generally speaking, in PluginPlay most data that needs checkpointed will live
in the cache.</p></li>
<li><p>C/R is related to memoization; primarily differs in that C/R needs to remain
valid for a much longer time frame than memoization</p></li>
<li><p>True C/R requires built in resiliency (storing redundant data)</p></li>
<li><p>Reloading a cache will allow PluginPlay to quickly regain parity with the
previous calculation by relying on memoization.</p></li>
<li><p>Converting from C/R format to memoized format may be necessary since the two
have different target time ranges.</p></li>
<li><p>Module developers may want to do their own C/R.</p></li>
</ul>
</section>
</section>
<section id="c-r-implementations">
<h2>C/R Implementations<a class="headerlink" href="#c-r-implementations" title="Link to this heading"></a></h2>
<p>Saving/loading is an ubiquitous aspect of the modern user experience. For this
reason we expected to find a number of existing C/R candidates; however, we
were only able to locate a few existing libraries. It is possible that we are
not using the correct terminology (we tried both the C/R and save/load
terminology), or that C/R is just so intimately tied to a program’s design that
no good general solution exists.</p>
<ul>
<li><p>DMTCP</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/dmtcp/dmtcp">https://github.com/dmtcp/dmtcp</a></p></li>
<li><p>Monitors a program’s processes and threads to automatically checkpoint it</p></li>
<li><p>Not at all clear how this works (grabbing all memory?)</p></li>
<li><p>LGPLv3</p></li>
<li><p>Active development. 291 stars and 27 watchers.</p></li>
</ul>
</li>
<li><p>SCR</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://github.com/LLNL/scr">https://github.com/LLNL/scr</a></p></li>
<li><p>Appears to primarily be used to save to a parallel filesystem in the
background.</p></li>
<li><p>Looks like user is still responsible for writing the files and interacting
with MPI.</p></li>
<li><p>Appears to require user to call program through SCR wrapper</p></li>
<li><p>BSD License.</p></li>
<li><p>Active development. 76 stars and 21 watchers.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>VELOC</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://github.com/ECP-VeloC/VELOC">https://github.com/ECP-VeloC/VELOC</a></p></li>
<li><p>Looks like it’s designed to replace SCR</p></li>
<li><p>Supports monitoring memory regions, will automatically C/R said regions</p></li>
<li><p>For more complex objects, has a file API. Like SCR users seem to be
responsible for manually filling in/reading from the file.</p></li>
<li><p>MIT License</p></li>
<li><p>Active development. 35 stars and 11 watchers.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not have experience using any of these libraries. Notes are based on
readmes and documentation, and may or may not actually reflect the features/
state of the libraries. Stars and watchers were accurate as of March 2022.</p>
</div>
</section>
<section id="c-r-strategy">
<h2>C/R Strategy<a class="headerlink" href="#c-r-strategy" title="Link to this heading"></a></h2>
<p>The existing C/R libraries do not seem to be widely used. Perhaps the larger
problem with the existing C/R libraries is that it is not clear what they have
to offer (unless our program is so simple we can just tell it what memory
addresses to monitor). For this reason, we have opted to implement our own C/R
solution.</p>
<p>C/R is a form of memoization and we intend for it to occur in PluginPlay via the
cache concept. Thus we punt almost all of the C/R considerations to the cache
discussion in <a class="reference internal" href="cache.html#cache-design"><span class="std std-ref">Cache Design</span></a>. The exceptions are the following
considerations which we address here:</p>
<ul class="simple">
<li><p>The amount of data to checkpoint can be formidable</p>
<ul>
<li><p>With the current strategy turning on/off memoization also turns off C/R.</p></li>
</ul>
</li>
<li><p>Generally speaking, in PluginPlay most data that needs checkpointed will live
in the cache.</p>
<ul>
<li><p>This is the primary motivation behind unify the two.</p></li>
</ul>
</li>
<li><p>Reloading a cache will allow PluginPlay to quickly regain parity with the
previous calculation by relying on memoization.</p>
<ul>
<li><p>The current C/R strategy relies heavily on this consideration</p></li>
</ul>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="memoization.html" class="btn btn-neutral float-left" title="Memoization Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../how_does_run_as_work.html" class="btn btn-neutral float-right" title="How Does run_as work?" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>